<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Discrete Probability Distribution | Introductory Statistics with R tidyverse</title>
  <meta name="description" content="Poisson Properties, Ladislaus Bortkiewicz and Prussian army horse-kick deaths." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Discrete Probability Distribution | Introductory Statistics with R tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Poisson Properties, Ladislaus Bortkiewicz and Prussian army horse-kick deaths." />
  <meta name="github-repo" content="fanwangecon/Stat4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Discrete Probability Distribution | Introductory Statistics with R tidyverse" />
  
  <meta name="twitter:description" content="Poisson Properties, Ladislaus Bortkiewicz and Prussian army horse-kick deaths." />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2020-05-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basics-of-probability.html"/>
<link rel="next" href="index-and-code-links.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-4');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introductory Statistics with R tidyverse</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="survey.html"><a href="survey.html"><i class="fa fa-check"></i><b>1</b> Survey</a>
<ul>
<li class="chapter" data-level="1.1" data-path="survey.html"><a href="survey.html#generate-a-dataset-in-r"><i class="fa fa-check"></i><b>1.1</b> Generate A Dataset in R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="survey.html"><a href="survey.html#a-random-sample-of-students-in-class"><i class="fa fa-check"></i><b>1.1.1</b> A Random Sample of Students in Class</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html"><i class="fa fa-check"></i><b>2</b> Dataset, Tables and Graphs</a>
<ul>
<li class="chapter" data-level="2.1" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html#opening-a-dataset"><i class="fa fa-check"></i><b>2.1</b> Opening a Dataset</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html#paths-to-data"><i class="fa fa-check"></i><b>2.1.1</b> Paths to Data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html#one-variable-graphs-and-tables"><i class="fa fa-check"></i><b>2.2</b> One Variable Graphs and Tables</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html#categoricaldiscrete"><i class="fa fa-check"></i><b>2.2.1</b> Categorical/Discrete</a></li>
<li class="chapter" data-level="2.2.2" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html#continuousquantitative"><i class="fa fa-check"></i><b>2.2.2</b> Continuous/Quantitative</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html#multiple-variables-graphs-and-tables"><i class="fa fa-check"></i><b>2.3</b> Multiple Variables Graphs and Tables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html#two-continuous-variables"><i class="fa fa-check"></i><b>2.3.1</b> Two Continuous Variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html#two-categorical-variables"><i class="fa fa-check"></i><b>2.3.2</b> Two Categorical Variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="dataset-tables-and-graphs.html"><a href="dataset-tables-and-graphs.html#continuous-and-categorical-variable"><i class="fa fa-check"></i><b>2.3.3</b> Continuous and Categorical Variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>3</b> Summarizing Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#mean-and-standard-deviation"><i class="fa fa-check"></i><b>3.1</b> Mean and Standard Deviation</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="summarizing-data.html"><a href="summarizing-data.html#temperature-across-locations-over-time"><i class="fa fa-check"></i><b>3.1.1</b> Temperature Across Locations over Time</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#coefficient-of-variation-and-correlation"><i class="fa fa-check"></i><b>3.2</b> Coefficient of Variation and Correlation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#education-and-wage"><i class="fa fa-check"></i><b>3.2.1</b> Education and Wage</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basics-of-probability.html"><a href="basics-of-probability.html"><i class="fa fa-check"></i><b>4</b> Basics of Probability</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basics-of-probability.html"><a href="basics-of-probability.html#experimental-outcomes"><i class="fa fa-check"></i><b>4.1</b> Experimental Outcomes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="basics-of-probability.html"><a href="basics-of-probability.html#sample-space-and-probabilities"><i class="fa fa-check"></i><b>4.1.1</b> Sample Space and Probabilities</a></li>
<li class="chapter" data-level="4.1.2" data-path="basics-of-probability.html"><a href="basics-of-probability.html#union-and-intersection-and-complements"><i class="fa fa-check"></i><b>4.1.2</b> Union and Intersection and Complements</a></li>
<li class="chapter" data-level="4.1.3" data-path="basics-of-probability.html"><a href="basics-of-probability.html#conditional-probability"><i class="fa fa-check"></i><b>4.1.3</b> Conditional Probability</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basics-of-probability.html"><a href="basics-of-probability.html#sample-space-and-probability-examples"><i class="fa fa-check"></i><b>4.2</b> Sample Space and Probability Examples</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="basics-of-probability.html"><a href="basics-of-probability.html#presidential-election"><i class="fa fa-check"></i><b>4.2.1</b> Presidential Election</a></li>
<li class="chapter" data-level="4.2.2" data-path="basics-of-probability.html"><a href="basics-of-probability.html#throwing-a-dice"><i class="fa fa-check"></i><b>4.2.2</b> Throwing a Dice</a></li>
<li class="chapter" data-level="4.2.3" data-path="basics-of-probability.html"><a href="basics-of-probability.html#two-basketball-games"><i class="fa fa-check"></i><b>4.2.3</b> Two Basketball Games</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="basics-of-probability.html"><a href="basics-of-probability.html#sample-average"><i class="fa fa-check"></i><b>4.3</b> Sample Average</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="basics-of-probability.html"><a href="basics-of-probability.html#an-unfair-dice"><i class="fa fa-check"></i><b>4.3.1</b> An Unfair Dice</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="basics-of-probability.html"><a href="basics-of-probability.html#multiple-step-experiment"><i class="fa fa-check"></i><b>4.4</b> Multiple-Step Experiment</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="basics-of-probability.html"><a href="basics-of-probability.html#playing-the-lottery-three-times"><i class="fa fa-check"></i><b>4.4.1</b> Playing the Lottery Three times</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="discrete-probability-distribution.html"><a href="discrete-probability-distribution.html"><i class="fa fa-check"></i><b>5</b> Discrete Probability Distribution</a>
<ul>
<li class="chapter" data-level="5.1" data-path="discrete-probability-distribution.html"><a href="discrete-probability-distribution.html#discrete-random-variable-and-binomial"><i class="fa fa-check"></i><b>5.1</b> Discrete Random Variable and Binomial</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="discrete-probability-distribution.html"><a href="discrete-probability-distribution.html#discrete-random-variable"><i class="fa fa-check"></i><b>5.1.1</b> Discrete Random Variable</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="discrete-probability-distribution.html"><a href="discrete-probability-distribution.html#binomial-experiment"><i class="fa fa-check"></i><b>5.2</b> Binomial Experiment</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="discrete-probability-distribution.html"><a href="discrete-probability-distribution.html#binomial-example-larceny"><i class="fa fa-check"></i><b>5.2.1</b> Binomial Example: Larceny</a></li>
<li class="chapter" data-level="5.2.2" data-path="discrete-probability-distribution.html"><a href="discrete-probability-distribution.html#binomial-example-wwii-german-soldier"><i class="fa fa-check"></i><b>5.2.2</b> Binomial Example: WWII German Soldier</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="discrete-probability-distribution.html"><a href="discrete-probability-distribution.html#poisson-distribution"><i class="fa fa-check"></i><b>5.3</b> Poisson Distribution</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="discrete-probability-distribution.html"><a href="discrete-probability-distribution.html#poisson-example-horse-kicking"><i class="fa fa-check"></i><b>5.3.1</b> Poisson Example: Horse-Kicking</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#survey-links"><i class="fa fa-check"></i><b>A.1</b> Survey links</a></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#dataset-tables-and-graphs-links"><i class="fa fa-check"></i><b>A.2</b> Dataset, Tables and Graphs links</a></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarizing-data-links"><i class="fa fa-check"></i><b>A.3</b> Summarizing Data links</a></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#basics-of-probability-links"><i class="fa fa-check"></i><b>A.4</b> Basics of Probability links</a></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#discrete-probability-distribution-links"><i class="fa fa-check"></i><b>A.5</b> Discrete Probability Distribution links</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/Stat4Econ/bookdown/index.html" target="blank">Stat4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory Statistics with R tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="discrete-probability-distribution" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Discrete Probability Distribution</h1>

<div id="discrete-random-variable-and-binomial" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Discrete Random Variable and Binomial</h2>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p><strong><a href="https://fanwangecon.github.io/Stat4Econ/">Back to Fan’s Intro Stat Table of Content</a></strong></p>
<p>We have been looking at various examples of discrete Random Variables in <a href="https://fanwangecon.github.io/Stat4Econ/probability/htmlpdfr/samplespace.html">Sample Space, Experimental Outcomes, Events, Probabilities</a>, <a href="https://fanwangecon.github.io/Stat4Econ/probability/htmlpdfr/samplespaceexa.html">Examples of Sample Space and Probabilities</a>, <a href="https://fanwangecon.github.io/Stat4Econ/probability/htmlpdfr/lottery.html">Multiple-Step Experiment: Playing the Lottery Three times</a>, and <a href="https://fanwangecon.github.io/Stat4Econ/probability/htmlpdfr/samplespacedice.html">Throw an Unfair Four Sided Dice</a>.</p>
<p>Now we state this a little bit more formally.</p>
<div id="discrete-random-variable" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Discrete Random Variable</h3>
<ol style="list-style-type: decimal">
<li>Random Variable
<ul>
<li>“A random variable is a numerical description of the outcome of an experiment.” (ASWCC P217)
<span class="math display">\[ \text{we could use letter } x \text{ to represent a random variable}\]</span></li>
</ul></li>
<li>Discrete Random Variables
<ul>
<li>“A random variable that may assume either a finite number of values or an infinite sequence of values such as <span class="math inline">\(0,1,2,...\)</span> is referred to as a discrete random variable.” (ASWCC P217)</li>
</ul></li>
<li>Discrete Probability Mass Function
<ul>
<li>“For a discrete random variable <span class="math inline">\(x\)</span>, a probability function, denoted by <span class="math inline">\(f(x)\)</span>, provides the probability for each value of the random variable.” (ASWCC P220)</li>
<li>We can think of different values of <span class="math inline">\(x\)</span> as been mapped from an experimental outcome in the sample space. Probability can not be negative, and the sum of the probability of different possible <span class="math inline">\(x\)</span> outcomes sum to 1 (ASWCC P221):
<span class="math display">\[ f(x) \ge 0\]</span>
<span class="math display">\[\Sigma f(x) = 1\]</span></li>
</ul></li>
<li>Expected Value of a Discrete Random Variable (ASWCC P225)
<span class="math display">\[E(x) = \mu_x = \Sigma x \cdot f(x)\]</span></li>
<li>Variance of a Discrete Random Variable (ASWCC P225)
<span class="math display">\[Var(x) = \sigma_x^2 = \Sigma \left( (x - \mu_x)^2 \cdot f(x) \right)\]</span></li>
</ol>
<p><em>Well Known Discrete Probability Distributions</em></p>
<p>There is a <a href="https://en.wikipedia.org/wiki/List_of_probability_distributions#Discrete_distributions">variety of</a> different Discrete Random Variable Probability Mass Functions that are appropriate for analyzing different situations. Think of these as tools, you don’t need to memorize the formulas, but you can learn about under what conditions these distributions are useful. Learn about the parameters of these distributions, and use the appropriate Excel or R function.</p>
<p>The simplest distribution is the <a href="https://en.wikipedia.org/wiki/Discrete_uniform_distribution">Discrete Uniform Distribution</a>. The uniform probability mass function is: <span class="math inline">\(f(x) = \frac{1}{n}\)</span>, where <span class="math inline">\(n\)</span> is the <em>the number of values the random variable may assume</em>, corresponding to experimental outcomes. (ASWCC P222)</p>
<p>We focus on the Binomial Distribution here, a variety of other distributions are related to the binomial distribution:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial Distribution</a></li>
<li><a href="https://en.wikipedia.org/wiki/Bernoulli_distribution">Bernoulli Distribution</a></li>
<li><a href="https://en.wikipedia.org/wiki/Hypergeometric_distribution">Hypergeometric Distribution</a></li>
<li><a href="https://en.wikipedia.org/wiki/Beta-binomial_distribution">Beta-Binomial Distribution</a></li>
</ul>
</div>
</div>
<div id="binomial-experiment" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Binomial Experiment</h2>
<p>We have already examined <a href="https://fanwangecon.github.io/Stat4Econ/probability/htmlpdfr/lottery.html">Multiple-Step Experiment: Playing the Lottery Three times</a>. Here we re-state the four properties of the <a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial Experiment</a> (ASWCC P240):</p>
<ol style="list-style-type: decimal">
<li>“The experiment consists of a sequence of <span class="math inline">\(n\)</span> identical trials.”</li>
<li>“Two outcomes are possible on each trial. We refer to one outcome as a success and the other outcome as a failure.”</li>
<li>“The probability of a success, denoted by <span class="math inline">\(p\)</span>, does not change from trial to trial. Consequently, the probability of a failure, denoted by <span class="math inline">\(1-p\)</span>, does not change from trial to trial.”</li>
<li>“The trials are independent.”</li>
</ol>
<p><strong>Binomial Sample Space</strong></p>
<p>Note that given that there are <span class="math inline">\(n\)</span> trials, the possible <span class="math inline">\(x\)</span> go from <span class="math inline">\(x=0\)</span> to <span class="math inline">\(x=n\)</span>. In another word, if there are three trials, <span class="math inline">\(n=3\)</span>, there are four possible experimental outcomes for <span class="math inline">\(x\)</span>.</p>
<ul>
<li>Experiment: The binomial experiment with <span class="math inline">\(n\)</span> trials</li>
<li>Experimental outcomes: <span class="math inline">\(x=0,x=1,...,x=\left(n-1\right),x=n\)</span></li>
<li>Sample Space: <span class="math inline">\(S=\left\{0,1,...,n-1,n\right\}\)</span></li>
</ul>
<p><strong>Binomial Probability Mass Funcion</strong></p>
<p>What is the probability of having <span class="math inline">\(x\)</span> success out of <span class="math inline">\(n\)</span> trials, given that there is <span class="math inline">\(p\)</span> chance of success for each trial and the assumptions above? The answer is given by this formula, which is the binomial probability mass function:
<span class="math display">\[
f(x;n,p) = C^{n}_{x} \cdot p^x \cdot \left(1-p\right)^{n-x}
         = \frac{n!}{\left(n-x\right)! \cdot x!} \cdot p^x \cdot \left(1-p\right)^{n-x}\\
\]</span></p>
<p>With the binomial experiment, we can now use a formula to assign probabilities. A formula is a piece of machinery that takes inputs and spits out outputs, Thie binomial probability mass function has three inputs, <span class="math inline">\(x\)</span>, <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>. You need to tell R, Excel, or alternative programs what these three numbers are, and the program will spit a probability out for you. <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> are the parameters.</p>
<p><strong>Binomial Expected Value and Variance</strong></p>
<p>For the binomial discrete random variable, it turns out the expected value and variance are:
<span class="math display">\[E(x) = n \cdot p\]</span>
<span class="math display">\[Var(x) = n \cdot p \cdot (1-p)\]</span>
We can find the expected value and variance by summing over all terms following: <span class="math inline">\(E(x) = \mu_x = \Sigma x \cdot f(x)\)</span> and <span class="math inline">\(Var(x) = \sigma_x^2 = \Sigma \left( (x - \mu_x)^2 \cdot f(x) \right)\)</span>, and we will always end up with these two results. It is intuitive. The average number of wins given that you play <span class="math inline">\(n\)</span> trials and given that the chance of winning each game is <span class="math inline">\(p\)</span> is <span class="math inline">\(n \cdot p\)</span>.</p>
<div id="binomial-example-larceny" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Binomial Example: Larceny</h3>
<p>In 2004, in the United State, <a href="https://en.wikipedia.org/wiki/Clearance_rate">18.3 percent of Larceny-Theft were cleared</a>. “Clearance rates are used by various groups as a measure of crimes solved by the police.”</p>
<div id="chance-of-x-out-n-arrested" class="section level4" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Chance of x out n Arrested</h4>
<p>10 people commit 10 larceny-theft crimes, suppose the situation follows the conditions of the binomial experiment, what is the chance that nobody is arrested? The chance that 1, 2, 3, or all 10 are arrested?</p>
<ul>
<li><span class="math inline">\(n=10\)</span>: 10 crimes, 10 trials</li>
<li><span class="math inline">\(p=0.183\)</span>: what is <span class="math inline">\(p\)</span> here? For the police success is clearing a crime.</li>
<li><span class="math inline">\(x\)</span>: if <span class="math inline">\(x=10\)</span>, that means all larceny-thefts were cleared, if <span class="math inline">\(x=0\)</span>, this means the police failed to clear all 10 thefts.</li>
</ul>
<p>For example, the chance that <span class="math inline">\(2\)</span> out of <span class="math inline">\(10\)</span> is arrested is:
<span class="math display">\[f\left(x=2;n=10,p=0.183\right) = \frac{10!}{\left(10-2\right)! \cdot 2!} \cdot 0.183^2 \cdot \left(1-0.183\right)^{10-2} = 0.299\]</span></p>
<p>We can use the r function, <em>dbinom</em>, to calculate these probabilites: <em>dbinom(2,10,0.183)</em>. Additionally, <em>pbinom(2,10,0.183)</em> tells us the cumulative probability that at most 2 out of 10 are arrested.</p>
<p>We do this in the code below. From the graph below, we can see that there is a 13.3% chance that none of the 10 thieves would be arrested, and alomst 0 percent chance that all 10 of then would be arrested. The chance that 6 out of the 10 thiefs would be arrested is less than 1 percent.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="discrete-probability-distribution.html#cb72-1"></a><span class="co"># library</span></span>
<span id="cb72-2"><a href="discrete-probability-distribution.html#cb72-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb72-3"><a href="discrete-probability-distribution.html#cb72-3"></a></span>
<span id="cb72-4"><a href="discrete-probability-distribution.html#cb72-4"></a><span class="co"># Parameters</span></span>
<span id="cb72-5"><a href="discrete-probability-distribution.html#cb72-5"></a>n &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb72-6"><a href="discrete-probability-distribution.html#cb72-6"></a>p &lt;-<span class="st"> </span><span class="fl">0.183</span></span>
<span id="cb72-7"><a href="discrete-probability-distribution.html#cb72-7"></a></span>
<span id="cb72-8"><a href="discrete-probability-distribution.html#cb72-8"></a><span class="co"># A vector of different arrest counts</span></span>
<span id="cb72-9"><a href="discrete-probability-distribution.html#cb72-9"></a>zero2max &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span>n</span>
<span id="cb72-10"><a href="discrete-probability-distribution.html#cb72-10"></a></span>
<span id="cb72-11"><a href="discrete-probability-distribution.html#cb72-11"></a><span class="co"># Probability for different arrest counts</span></span>
<span id="cb72-12"><a href="discrete-probability-distribution.html#cb72-12"></a>prob_of_arrests &lt;-<span class="st"> </span><span class="kw">dbinom</span>(zero2max, n, p)</span>
<span id="cb72-13"><a href="discrete-probability-distribution.html#cb72-13"></a></span>
<span id="cb72-14"><a href="discrete-probability-distribution.html#cb72-14"></a><span class="co"># Control Graph Size</span></span>
<span id="cb72-15"><a href="discrete-probability-distribution.html#cb72-15"></a><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">5</span>, <span class="dt">repr.plot.height =</span> <span class="dv">4</span>)</span>
<span id="cb72-16"><a href="discrete-probability-distribution.html#cb72-16"></a></span>
<span id="cb72-17"><a href="discrete-probability-distribution.html#cb72-17"></a><span class="co"># Number of Arrests Probabilities</span></span>
<span id="cb72-18"><a href="discrete-probability-distribution.html#cb72-18"></a>arrest.prob.mass &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">arrests=</span>zero2max, <span class="dt">prob=</span>prob_of_arrests)</span>
<span id="cb72-19"><a href="discrete-probability-distribution.html#cb72-19"></a></span>
<span id="cb72-20"><a href="discrete-probability-distribution.html#cb72-20"></a><span class="co"># Titles Strings etc</span></span>
<span id="cb72-21"><a href="discrete-probability-distribution.html#cb72-21"></a>graph.title &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&#39;Prob for Number of Theft-Criminals Arrested out of %s&#39;</span> ,n)</span>
<span id="cb72-22"><a href="discrete-probability-distribution.html#cb72-22"></a>graph.caption &lt;-<span class="st"> </span><span class="kw">sprintf</span>(</span>
<span id="cb72-23"><a href="discrete-probability-distribution.html#cb72-23"></a>    <span class="kw">paste0</span>(<span class="st">&#39;Assuming the binomial properties apply</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb72-24"><a href="discrete-probability-distribution.html#cb72-24"></a>           <span class="st">&#39;2004 Larceny/Left USA Clearance Rate = %s&#39;</span>), p)</span>
<span id="cb72-25"><a href="discrete-probability-distribution.html#cb72-25"></a></span>
<span id="cb72-26"><a href="discrete-probability-distribution.html#cb72-26"></a><span class="co"># Create a Table and Graph it</span></span>
<span id="cb72-27"><a href="discrete-probability-distribution.html#cb72-27"></a>arrest.graph &lt;-<span class="st"> </span>arrest.prob.mass <span class="op">%&gt;%</span></span>
<span id="cb72-28"><a href="discrete-probability-distribution.html#cb72-28"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>arrests, <span class="dt">y=</span>prob, <span class="dt">label =</span> <span class="kw">sprintf</span>(<span class="st">&#39;%0.3f&#39;</span>, prob))) <span class="op">+</span></span>
<span id="cb72-29"><a href="discrete-probability-distribution.html#cb72-29"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&#39;identity&#39;</span>) <span class="op">+</span></span>
<span id="cb72-30"><a href="discrete-probability-distribution.html#cb72-30"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">vjust =</span> <span class="fl">-0.5</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb72-31"><a href="discrete-probability-distribution.html#cb72-31"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> graph.title,</span>
<span id="cb72-32"><a href="discrete-probability-distribution.html#cb72-32"></a>         <span class="dt">x =</span> <span class="st">&#39;Number of Criminals Arrests&#39;</span>,</span>
<span id="cb72-33"><a href="discrete-probability-distribution.html#cb72-33"></a>         <span class="dt">y =</span> <span class="st">&#39;Prob of x Arrested&#39;</span>,</span>
<span id="cb72-34"><a href="discrete-probability-distribution.html#cb72-34"></a>         <span class="dt">caption =</span> graph.caption) <span class="op">+</span></span>
<span id="cb72-35"><a href="discrete-probability-distribution.html#cb72-35"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> zero2max, <span class="dt">breaks =</span> zero2max) <span class="op">+</span></span>
<span id="cb72-36"><a href="discrete-probability-distribution.html#cb72-36"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span>
<span id="cb72-37"><a href="discrete-probability-distribution.html#cb72-37"></a></span>
<span id="cb72-38"><a href="discrete-probability-distribution.html#cb72-38"></a><span class="kw">print</span>(arrest.graph)</span></code></pre></div>
<p><img src="Introductory-Statistics-with-R-tidyverse_files/figure-html/unnamed-chunk-72-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="what-is-the-chance-of-arrest-at-least-x-out-of-n-people" class="section level4" number="5.2.1.2">
<h4><span class="header-section-number">5.2.1.2</span> What is the Chance of Arrest at Least X out of N People</h4>
<p>What is the chance that at most 3 out of the 10 thiefs are arrested? That includes the chance that no one is arrested, 1, 2, or 3 people are arrested:</p>
<p><span class="math display">\[
 p\left(x \le 3;n=10,p=0.183\right) \\
=\Sigma_{x=0}^{3} \left( f\left(x;n=10,p=0.183\right) \right) \\
=\Sigma_{x=0}^3 \left( \frac{10!}{\left(10-x\right)! \cdot x!} \cdot 0.183^x \cdot \left(1-0.183\right)^{10-x} \right)\\
=0.133 + 0.297 + 0.299 + 0.179\\
=0.907\\
\]</span></p>
<p>Given the low clearance rate, there is a <span class="math inline">\(90\)</span> percent chance that at most 3 out of 10 criminals are arrested.</p>
<p>We can graph this out. We will graph the previous graph again but overlay the cumulative probability on top.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="discrete-probability-distribution.html#cb73-1"></a><span class="co"># Cumulative Probability for different arrest counts, before dbinom, now pbinom</span></span>
<span id="cb73-2"><a href="discrete-probability-distribution.html#cb73-2"></a>cumulative_prob_of_arrests &lt;-<span class="st"> </span><span class="kw">pbinom</span>(zero2max, n, p)</span>
<span id="cb73-3"><a href="discrete-probability-distribution.html#cb73-3"></a></span>
<span id="cb73-4"><a href="discrete-probability-distribution.html#cb73-4"></a><span class="co"># Data File that Includes Cumulative Probability and Mass</span></span>
<span id="cb73-5"><a href="discrete-probability-distribution.html#cb73-5"></a>arrest.prob &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">arrests=</span>(zero2max), <span class="dt">prob=</span>prob_of_arrests, <span class="dt">cum.prob=</span>cumulative_prob_of_arrests)</span>
<span id="cb73-6"><a href="discrete-probability-distribution.html#cb73-6"></a></span>
<span id="cb73-7"><a href="discrete-probability-distribution.html#cb73-7"></a><span class="co"># Control Graph Size</span></span>
<span id="cb73-8"><a href="discrete-probability-distribution.html#cb73-8"></a><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">5</span>, <span class="dt">repr.plot.height =</span> <span class="dv">4</span>)</span>
<span id="cb73-9"><a href="discrete-probability-distribution.html#cb73-9"></a></span>
<span id="cb73-10"><a href="discrete-probability-distribution.html#cb73-10"></a><span class="co"># Create a Table and Graph it</span></span>
<span id="cb73-11"><a href="discrete-probability-distribution.html#cb73-11"></a><span class="co">#     geom_text(aes(y=prob, label = sprintf(&#39;%0.3f&#39;, prob)), vjust = -0.5, size = 3) +</span></span>
<span id="cb73-12"><a href="discrete-probability-distribution.html#cb73-12"></a></span>
<span id="cb73-13"><a href="discrete-probability-distribution.html#cb73-13"></a>axis.sec.ratio &lt;-<span class="st"> </span><span class="kw">max</span>(cumulative_prob_of_arrests)<span class="op">/</span><span class="kw">max</span>(prob_of_arrests)</span>
<span id="cb73-14"><a href="discrete-probability-distribution.html#cb73-14"></a>right.axis.color &lt;-<span class="st"> &#39;blue&#39;</span></span>
<span id="cb73-15"><a href="discrete-probability-distribution.html#cb73-15"></a>left.axis.color &lt;-<span class="st"> &#39;red&#39;</span></span>
<span id="cb73-16"><a href="discrete-probability-distribution.html#cb73-16"></a></span>
<span id="cb73-17"><a href="discrete-probability-distribution.html#cb73-17"></a><span class="co"># Probabilities</span></span>
<span id="cb73-18"><a href="discrete-probability-distribution.html#cb73-18"></a>arrest.graph &lt;-<span class="st"> </span>arrest.prob <span class="op">%&gt;%</span></span>
<span id="cb73-19"><a href="discrete-probability-distribution.html#cb73-19"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>arrests)) <span class="op">+</span></span>
<span id="cb73-20"><a href="discrete-probability-distribution.html#cb73-20"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y=</span>prob),</span>
<span id="cb73-21"><a href="discrete-probability-distribution.html#cb73-21"></a>             <span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>, <span class="dt">width=</span><span class="fl">0.5</span>, <span class="dt">fill=</span>left.axis.color) <span class="op">+</span></span>
<span id="cb73-22"><a href="discrete-probability-distribution.html#cb73-22"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y=</span>prob,</span>
<span id="cb73-23"><a href="discrete-probability-distribution.html#cb73-23"></a>                  <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="kw">sprintf</span>(<span class="st">&#39;%2.1f&#39;</span>, prob<span class="op">*</span><span class="dv">100</span>), <span class="st">&#39;%&#39;</span>)),</span>
<span id="cb73-24"><a href="discrete-probability-distribution.html#cb73-24"></a>              <span class="dt">vjust =</span> <span class="fl">-0.5</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">color=</span>left.axis.color, <span class="dt">fontface=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb73-25"><a href="discrete-probability-distribution.html#cb73-25"></a></span>
<span id="cb73-26"><a href="discrete-probability-distribution.html#cb73-26"></a><span class="co"># Cumulative Probabilities</span></span>
<span id="cb73-27"><a href="discrete-probability-distribution.html#cb73-27"></a>arrest.graph &lt;-<span class="st"> </span>arrest.graph <span class="op">+</span></span>
<span id="cb73-28"><a href="discrete-probability-distribution.html#cb73-28"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>cum.prob<span class="op">/</span>axis.sec.ratio),</span>
<span id="cb73-29"><a href="discrete-probability-distribution.html#cb73-29"></a>              <span class="dt">alpha=</span><span class="fl">0.25</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">color=</span>right.axis.color) <span class="op">+</span></span>
<span id="cb73-30"><a href="discrete-probability-distribution.html#cb73-30"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y=</span>cum.prob<span class="op">/</span>axis.sec.ratio),</span>
<span id="cb73-31"><a href="discrete-probability-distribution.html#cb73-31"></a>               <span class="dt">alpha=</span><span class="fl">0.75</span>, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">shape=</span><span class="dv">23</span>, <span class="dt">fill=</span>right.axis.color) <span class="op">+</span></span>
<span id="cb73-32"><a href="discrete-probability-distribution.html#cb73-32"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y=</span>cum.prob<span class="op">/</span>axis.sec.ratio,</span>
<span id="cb73-33"><a href="discrete-probability-distribution.html#cb73-33"></a>                  <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="kw">sprintf</span>(<span class="st">&#39;%2.0f&#39;</span>, cum.prob<span class="op">*</span><span class="dv">100</span>), <span class="st">&#39;%&#39;</span>)),</span>
<span id="cb73-34"><a href="discrete-probability-distribution.html#cb73-34"></a>              <span class="dt">vjust =</span> <span class="fl">-0.5</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">color=</span>right.axis.color, <span class="dt">fontface=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb73-35"><a href="discrete-probability-distribution.html#cb73-35"></a></span>
<span id="cb73-36"><a href="discrete-probability-distribution.html#cb73-36"></a><span class="co"># Titles Strings etc</span></span>
<span id="cb73-37"><a href="discrete-probability-distribution.html#cb73-37"></a>graph.title &lt;-<span class="st"> </span><span class="kw">sprintf</span>(</span>
<span id="cb73-38"><a href="discrete-probability-distribution.html#cb73-38"></a>    <span class="kw">paste0</span>(<span class="st">&#39;Number of Theft-Criminals Arrested out of %s</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb73-39"><a href="discrete-probability-distribution.html#cb73-39"></a>           <span class="st">&#39;Prob Mass (Left) and Cumulative Prob (Right)&#39;</span>), n)</span>
<span id="cb73-40"><a href="discrete-probability-distribution.html#cb73-40"></a>graph.caption &lt;-<span class="st"> </span><span class="kw">sprintf</span>(</span>
<span id="cb73-41"><a href="discrete-probability-distribution.html#cb73-41"></a>    <span class="kw">paste0</span>(<span class="st">&#39;Assuming the binomial properties apply</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb73-42"><a href="discrete-probability-distribution.html#cb73-42"></a>           <span class="st">&#39;2004 Larceny/Left USA Clearance Rate = %s&#39;</span>), p)</span>
<span id="cb73-43"><a href="discrete-probability-distribution.html#cb73-43"></a>graph.title.x &lt;-<span class="st"> &#39;Number of Criminals Arrests&#39;</span></span>
<span id="cb73-44"><a href="discrete-probability-distribution.html#cb73-44"></a>graph.title.y.axisleft &lt;-<span class="st"> &#39;Prob of x Arrested&#39;</span></span>
<span id="cb73-45"><a href="discrete-probability-distribution.html#cb73-45"></a>graph.title.y.axisright &lt;-<span class="st"> &#39;Prob of at most x Arrested&#39;</span></span>
<span id="cb73-46"><a href="discrete-probability-distribution.html#cb73-46"></a></span>
<span id="cb73-47"><a href="discrete-probability-distribution.html#cb73-47"></a><span class="co"># Title</span></span>
<span id="cb73-48"><a href="discrete-probability-distribution.html#cb73-48"></a>arrest.graph &lt;-<span class="st"> </span>arrest.graph <span class="op">+</span></span>
<span id="cb73-49"><a href="discrete-probability-distribution.html#cb73-49"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> graph.title,</span>
<span id="cb73-50"><a href="discrete-probability-distribution.html#cb73-50"></a>         <span class="dt">x =</span> graph.title.x, <span class="dt">y =</span> graph.title.y.axisleft,</span>
<span id="cb73-51"><a href="discrete-probability-distribution.html#cb73-51"></a>         <span class="dt">caption =</span> graph.caption) <span class="op">+</span></span>
<span id="cb73-52"><a href="discrete-probability-distribution.html#cb73-52"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">sec.axis =</span></span>
<span id="cb73-53"><a href="discrete-probability-distribution.html#cb73-53"></a>                       <span class="kw">sec_axis</span>(<span class="op">~</span>.<span class="op">*</span>axis.sec.ratio, <span class="dt">name =</span> graph.title.y.axisright)) <span class="op">+</span></span>
<span id="cb73-54"><a href="discrete-probability-distribution.html#cb73-54"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> zero2max, <span class="dt">breaks =</span> zero2max) <span class="op">+</span></span>
<span id="cb73-55"><a href="discrete-probability-distribution.html#cb73-55"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">face=</span><span class="st">&#39;bold&#39;</span>),</span>
<span id="cb73-56"><a href="discrete-probability-distribution.html#cb73-56"></a>          <span class="dt">axis.text.y.right =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> right.axis.color),</span>
<span id="cb73-57"><a href="discrete-probability-distribution.html#cb73-57"></a>          <span class="dt">axis.text.y.left =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> left.axis.color))</span>
<span id="cb73-58"><a href="discrete-probability-distribution.html#cb73-58"></a></span>
<span id="cb73-59"><a href="discrete-probability-distribution.html#cb73-59"></a><span class="co"># Print</span></span>
<span id="cb73-60"><a href="discrete-probability-distribution.html#cb73-60"></a><span class="kw">print</span>(arrest.graph)</span></code></pre></div>
<p><img src="Introductory-Statistics-with-R-tidyverse_files/figure-html/unnamed-chunk-73-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="binomial-example-wwii-german-soldier" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Binomial Example: WWII German Soldier</h3>
<p>During WWII, 13.6 million Germans served in the German army, and 4.2 million were killed or missing. This is a death rate of <a href="https://en.wikipedia.org/wiki/World_War_II_casualties#Military_casualties_by_branch_of_service">30.9 percent</a>.</p>
<p>Suppose there are many German towns that each sent 100 soldiers to the front, suppose the binomial properties apply, what is the fraction of solidiers who will return to their towns after the war?</p>
<ul>
<li><span class="math inline">\(n=100\)</span>: suppose 100 solidiers from each German town went to join the German Army during WWII.</li>
<li><span class="math inline">\(p=1-0.309=0.691\)</span>: <span class="math inline">\(p\)</span> is the chance of survival.</li>
<li><span class="math inline">\(x\)</span>: if <span class="math inline">\(x=1\)</span>, that means 1 out of 100 survived.</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="discrete-probability-distribution.html#cb74-1"></a><span class="co"># Parameters</span></span>
<span id="cb74-2"><a href="discrete-probability-distribution.html#cb74-2"></a>n &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb74-3"><a href="discrete-probability-distribution.html#cb74-3"></a>p &lt;-<span class="st"> </span><span class="dv">1</span><span class="fl">-0.309</span></span>
<span id="cb74-4"><a href="discrete-probability-distribution.html#cb74-4"></a></span>
<span id="cb74-5"><a href="discrete-probability-distribution.html#cb74-5"></a><span class="co"># Generate Data</span></span>
<span id="cb74-6"><a href="discrete-probability-distribution.html#cb74-6"></a><span class="co"># A vector of different survival counts</span></span>
<span id="cb74-7"><a href="discrete-probability-distribution.html#cb74-7"></a>zero2max &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span>n</span>
<span id="cb74-8"><a href="discrete-probability-distribution.html#cb74-8"></a><span class="co"># Probability for different survival counts</span></span>
<span id="cb74-9"><a href="discrete-probability-distribution.html#cb74-9"></a>prob_of_survives &lt;-<span class="st"> </span><span class="kw">dbinom</span>(zero2max, n, p)</span>
<span id="cb74-10"><a href="discrete-probability-distribution.html#cb74-10"></a><span class="co"># Cumulative Probability for different survival counts, before dbinom, now pbinom</span></span>
<span id="cb74-11"><a href="discrete-probability-distribution.html#cb74-11"></a>cumulative_prob_of_survives &lt;-<span class="st"> </span><span class="kw">pbinom</span>(zero2max, n, p)</span>
<span id="cb74-12"><a href="discrete-probability-distribution.html#cb74-12"></a><span class="co"># Data File that Includes Cumulative Probability and Mass</span></span>
<span id="cb74-13"><a href="discrete-probability-distribution.html#cb74-13"></a>survive.prob &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">survives=</span>(zero2max), <span class="dt">prob=</span>prob_of_survives, <span class="dt">cum.prob=</span>cumulative_prob_of_survives)</span></code></pre></div>
<div id="wwii-german-soldiergraph" class="section level4" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> WWII German Soldier–Graph</h4>
<p>We can see the results graphically as well below. Note that the graph looks normal. This is indeed the case, when <span class="math inline">\(n\)</span> gets larger, the bionomial distribution approximates the normal distribution, with mean <span class="math inline">\(n\cdot p\)</span> and variance <span class="math inline">\(n \cdot p \cdot (1-p)\)</span>.</p>
<p>Again this is given binomial assumptions. Which means in this case that soldiers from each town has equal probability of dying. And the chance of one soldier from a town dying does not change the chance of other soldiers from the same town dying. These are unlikely to be correct assumptions, but maybe they are approximately right.</p>
<p>We can see from the figure below that if the survival distribution follows binomial, less than 1 percent of towns should expect more than 80 out of 100 soldiers to return. And less than 1 percent of towns should expect less than 57 soldiers to return. Hence:</p>
<ul>
<li>Given a 30.9 percent death rate, nearly all German towns will have between 57 to 80 soldiers returning from the war out the 100 they sent to join the German army.</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="discrete-probability-distribution.html#cb75-1"></a><span class="co"># Control Graph Size</span></span>
<span id="cb75-2"><a href="discrete-probability-distribution.html#cb75-2"></a><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">5</span>, <span class="dt">repr.plot.height =</span> <span class="dv">4</span>)</span>
<span id="cb75-3"><a href="discrete-probability-distribution.html#cb75-3"></a><span class="co"># Two axis colors</span></span>
<span id="cb75-4"><a href="discrete-probability-distribution.html#cb75-4"></a>axis.sec.ratio &lt;-<span class="st"> </span><span class="kw">max</span>(cumulative_prob_of_survives)<span class="op">/</span><span class="kw">max</span>(prob_of_survives)</span>
<span id="cb75-5"><a href="discrete-probability-distribution.html#cb75-5"></a>right.axis.color &lt;-<span class="st"> &#39;blue&#39;</span></span>
<span id="cb75-6"><a href="discrete-probability-distribution.html#cb75-6"></a>left.axis.color &lt;-<span class="st"> &#39;red&#39;</span></span>
<span id="cb75-7"><a href="discrete-probability-distribution.html#cb75-7"></a></span>
<span id="cb75-8"><a href="discrete-probability-distribution.html#cb75-8"></a><span class="co"># Probabilities</span></span>
<span id="cb75-9"><a href="discrete-probability-distribution.html#cb75-9"></a>survive.graph &lt;-<span class="st"> </span>survive.prob <span class="op">%&gt;%</span></span>
<span id="cb75-10"><a href="discrete-probability-distribution.html#cb75-10"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>survives)) <span class="op">+</span></span>
<span id="cb75-11"><a href="discrete-probability-distribution.html#cb75-11"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y=</span>prob),</span>
<span id="cb75-12"><a href="discrete-probability-distribution.html#cb75-12"></a>             <span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>, <span class="dt">width=</span><span class="fl">0.5</span>, <span class="dt">fill=</span>left.axis.color)</span>
<span id="cb75-13"><a href="discrete-probability-distribution.html#cb75-13"></a></span>
<span id="cb75-14"><a href="discrete-probability-distribution.html#cb75-14"></a><span class="co"># Cumulative Probabilities</span></span>
<span id="cb75-15"><a href="discrete-probability-distribution.html#cb75-15"></a>survive.graph &lt;-<span class="st"> </span>survive.graph <span class="op">+</span></span>
<span id="cb75-16"><a href="discrete-probability-distribution.html#cb75-16"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>cum.prob<span class="op">/</span>axis.sec.ratio),</span>
<span id="cb75-17"><a href="discrete-probability-distribution.html#cb75-17"></a>              <span class="dt">alpha=</span><span class="fl">0.75</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">color=</span>right.axis.color)</span>
<span id="cb75-18"><a href="discrete-probability-distribution.html#cb75-18"></a></span>
<span id="cb75-19"><a href="discrete-probability-distribution.html#cb75-19"></a><span class="co"># Titles Strings etc</span></span>
<span id="cb75-20"><a href="discrete-probability-distribution.html#cb75-20"></a>graph.title &lt;-<span class="st"> </span><span class="kw">sprintf</span>(</span>
<span id="cb75-21"><a href="discrete-probability-distribution.html#cb75-21"></a>    <span class="kw">paste0</span>(<span class="st">&#39;Number of Surviving Soldiers out of %s from Town</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb75-22"><a href="discrete-probability-distribution.html#cb75-22"></a>           <span class="st">&#39;Prob Mass (Left) and Cumulative Prob (Right)&#39;</span>) ,n)</span>
<span id="cb75-23"><a href="discrete-probability-distribution.html#cb75-23"></a>graph.caption &lt;-<span class="st"> </span><span class="kw">sprintf</span>(</span>
<span id="cb75-24"><a href="discrete-probability-distribution.html#cb75-24"></a>    <span class="kw">paste0</span>(<span class="st">&#39;Assuming the binomial properties apply</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb75-25"><a href="discrete-probability-distribution.html#cb75-25"></a>           <span class="st">&#39;German Army Soldier WWII survival rate = %s&#39;</span>), p)</span>
<span id="cb75-26"><a href="discrete-probability-distribution.html#cb75-26"></a>graph.title.x &lt;-<span class="st"> &#39;Number of Soldiers Survived&#39;</span></span>
<span id="cb75-27"><a href="discrete-probability-distribution.html#cb75-27"></a>graph.title.y.axisleft &lt;-<span class="st"> &#39;Prob of x survived&#39;</span></span>
<span id="cb75-28"><a href="discrete-probability-distribution.html#cb75-28"></a>graph.title.y.axisright &lt;-<span class="st"> &#39;Prob of at most x surviveed&#39;</span></span>
<span id="cb75-29"><a href="discrete-probability-distribution.html#cb75-29"></a></span>
<span id="cb75-30"><a href="discrete-probability-distribution.html#cb75-30"></a><span class="co"># Titles etc</span></span>
<span id="cb75-31"><a href="discrete-probability-distribution.html#cb75-31"></a>survive.graph &lt;-<span class="st"> </span>survive.graph <span class="op">+</span></span>
<span id="cb75-32"><a href="discrete-probability-distribution.html#cb75-32"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> graph.title,</span>
<span id="cb75-33"><a href="discrete-probability-distribution.html#cb75-33"></a>         <span class="dt">x =</span> graph.title.x,</span>
<span id="cb75-34"><a href="discrete-probability-distribution.html#cb75-34"></a>         <span class="dt">y =</span> graph.title.y.axisleft,</span>
<span id="cb75-35"><a href="discrete-probability-distribution.html#cb75-35"></a>         <span class="dt">caption =</span> graph.caption) <span class="op">+</span></span>
<span id="cb75-36"><a href="discrete-probability-distribution.html#cb75-36"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">sec.axis =</span></span>
<span id="cb75-37"><a href="discrete-probability-distribution.html#cb75-37"></a>                       <span class="kw">sec_axis</span>(<span class="op">~</span>.<span class="op">*</span>axis.sec.ratio, <span class="dt">name =</span> graph.title.y.axisright)) <span class="op">+</span></span>
<span id="cb75-38"><a href="discrete-probability-distribution.html#cb75-38"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> zero2max[<span class="kw">floor</span>(<span class="kw">seq</span>(<span class="dv">1</span>,n,<span class="dt">length.out=</span><span class="dv">10</span>))],</span>
<span id="cb75-39"><a href="discrete-probability-distribution.html#cb75-39"></a>                       <span class="dt">breaks =</span> zero2max[<span class="kw">floor</span>(<span class="kw">seq</span>(<span class="dv">1</span>,n,<span class="dt">length.out=</span><span class="dv">10</span>))]) <span class="op">+</span></span>
<span id="cb75-40"><a href="discrete-probability-distribution.html#cb75-40"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">face=</span><span class="st">&#39;bold&#39;</span>),</span>
<span id="cb75-41"><a href="discrete-probability-distribution.html#cb75-41"></a>          <span class="dt">axis.text.y.right =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> right.axis.color),</span>
<span id="cb75-42"><a href="discrete-probability-distribution.html#cb75-42"></a>          <span class="dt">axis.text.y.left =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> left.axis.color))</span>
<span id="cb75-43"><a href="discrete-probability-distribution.html#cb75-43"></a></span>
<span id="cb75-44"><a href="discrete-probability-distribution.html#cb75-44"></a><span class="co"># Print</span></span>
<span id="cb75-45"><a href="discrete-probability-distribution.html#cb75-45"></a><span class="kw">print</span>(survive.graph)</span></code></pre></div>
<p><img src="Introductory-Statistics-with-R-tidyverse_files/figure-html/unnamed-chunk-75-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="wwii-german-soldiertable" class="section level4" number="5.2.2.2">
<h4><span class="header-section-number">5.2.2.2</span> WWII German Soldier–Table</h4>
<p>We can see from the table of results what is the distribution of the number of soldiers returning to each village in greater detail.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="discrete-probability-distribution.html#cb76-1"></a><span class="co"># print(survive.prob)</span></span>
<span id="cb76-2"><a href="discrete-probability-distribution.html#cb76-2"></a><span class="co"># start_idx &lt;- 81</span></span>
<span id="cb76-3"><a href="discrete-probability-distribution.html#cb76-3"></a>f_table &lt;-<span class="st"> </span><span class="cf">function</span>(start_idx) {</span>
<span id="cb76-4"><a href="discrete-probability-distribution.html#cb76-4"></a></span>
<span id="cb76-5"><a href="discrete-probability-distribution.html#cb76-5"></a>    survive.subset &lt;-<span class="st"> </span><span class="kw">round</span>(survive.prob[<span class="kw">seq</span>(start_idx, start_idx<span class="op">+</span><span class="dv">20</span>),], <span class="dv">4</span>)</span>
<span id="cb76-6"><a href="discrete-probability-distribution.html#cb76-6"></a>    survive.subset<span class="op">$</span>prob &lt;-<span class="st"> </span><span class="kw">paste0</span>(survive.subset<span class="op">$</span>prob<span class="op">*</span><span class="dv">100</span>,</span>
<span id="cb76-7"><a href="discrete-probability-distribution.html#cb76-7"></a>                                  <span class="st">&#39;% chance EXACTLY (n=&#39;</span>, survive.subset<span class="op">$</span>survives, <span class="st">&#39;) survived&#39;</span>)</span>
<span id="cb76-8"><a href="discrete-probability-distribution.html#cb76-8"></a>    survive.subset<span class="op">$</span>one.minus.cum.prob &lt;-<span class="st"> </span><span class="kw">paste0</span>((<span class="dv">1</span><span class="op">-</span>survive.subset<span class="op">$</span>cum.prob)<span class="op">*</span><span class="dv">100</span>,</span>
<span id="cb76-9"><a href="discrete-probability-distribution.html#cb76-9"></a>                                                <span class="st">&#39;% chance AT LEAST (n=&#39;</span>, survive.subset<span class="op">$</span>survives, <span class="st">&#39;) survived&#39;</span>)</span>
<span id="cb76-10"><a href="discrete-probability-distribution.html#cb76-10"></a>    survive.subset<span class="op">$</span>cum.prob &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>((survive.subset<span class="op">$</span>cum.prob)<span class="op">*</span><span class="dv">100</span>, <span class="dv">4</span>),</span>
<span id="cb76-11"><a href="discrete-probability-distribution.html#cb76-11"></a>                                      <span class="st">&#39;% chance AT MOST (n=&#39;</span>, survive.subset<span class="op">$</span>survives, <span class="st">&#39;) survived&#39;</span>)</span>
<span id="cb76-12"><a href="discrete-probability-distribution.html#cb76-12"></a></span>
<span id="cb76-13"><a href="discrete-probability-distribution.html#cb76-13"></a>    <span class="kw">return</span>(survive.subset[,<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>])</span>
<span id="cb76-14"><a href="discrete-probability-distribution.html#cb76-14"></a>}</span>
<span id="cb76-15"><a href="discrete-probability-distribution.html#cb76-15"></a><span class="kw">lapply</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">21</span>,<span class="dv">41</span>,<span class="dv">61</span>,<span class="dv">81</span>), f_table)</span></code></pre></div>
<pre><code>## [[1]]
## 
## [[2]]
## 
## [[3]]
## 
## [[4]]
## 
## [[5]]</code></pre>

</div>
</div>
</div>
<div id="poisson-distribution" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Poisson Distribution</h2>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>We looked at the binomial probability distribution <a href="https://fanwangecon.github.io/Stat4Econ/probability/htmlpdfr/binomial.html">Discrete Random Variable and Binomial Experiment</a>. Now we look at the poisson distribution.</p>
<p>Suppose you run a restaurant, maybe you know on average how many guests arrive on a weekday night between 6 and 9, but every night the exact number might be different, what is the distribution of guest arrivals? By chance, there could be <span class="math inline">\(0\)</span> guests, there could also be a lot more guest than average potentially. We use the poisson distribution to think about these arrival probabilities.</p>
<p>For us to use the Poisson distribution, the experiment we study need to have these two properties (ASWCC P250):</p>
<ol style="list-style-type: decimal">
<li>“The probability of an occurrence is the same for any two intervals of equal length.”</li>
<li>“The occurrence or nonoccurrence in any interval is independent of the occurrence or nonoccurrence in any other interval.”</li>
</ol>
<p><strong>Poisson Sample Space</strong></p>
<p>Guests arrive at your restaurant between 6 and 9 on a weekday night, 0 guest could arrive, 1, 2, 3, …, 10, 11, 13, … , 20, 21, 22, …. Unlike in the Binomial case, where we have a maximum number of games that we can win out of <span class="math inline">\(n\)</span> games played, here we don’t impose a maximum number of guests that can arrive.</p>
<ul>
<li>Experiment: arrivals</li>
<li>Experimental outcomes: <span class="math inline">\(x=0,x=1,...,...\)</span>, unlike the bionomial, there is no limit here</li>
<li>Sample Space: <span class="math inline">\(S=\left\{0,1,...,...\right\}\)</span> (the support is infinite)</li>
</ul>
<p><strong>Poisson Probability Mass Funcion</strong></p>
<p>What is the probability of having <span class="math inline">\(x\)</span> arrivals during an interval of time given that the expected (mean) number of arrival in that interval of time is <span class="math inline">\(\mu\)</span>? The answer is given by this formula, which is the poisson probability mass function:</p>
<p><span class="math display">\[\begin{eqnarray}
f(x;\mu) &amp;=&amp; \frac{\mu^{x} \cdot e^{-\mu}}{x!}\\
\end{eqnarray}\]</span></p>
<p>With the poisson experiment, we have this formula to assign probabilities. The formula has two inputs, <span class="math inline">\(x\)</span> and <span class="math inline">\(\mu\)</span>. <span class="math inline">\(e=2.71828\)</span> is not a parameter, it is a fixed number like <span class="math inline">\(\pi\)</span>, it is a mathematical constant. You need to tell R, Excel, or alternative programs what these two numbers <span class="math inline">\(x\)</span> and <span class="math inline">\(\mu\)</span> are, and the program will spit a probability out for you. <span class="math inline">\(\mu\)</span> is the parameter.</p>
<p><strong>Poisson Expected Value and Variance</strong></p>
<p>For the Poisson discrete random variable, it turns out the expected value and variance are:
<span class="math display">\[E(x) = \mu\]</span>
<span class="math display">\[Var(x) = \mu\]</span></p>
<p>We can check by summing over : <span class="math inline">\(E(x) = \mu_x = \Sigma x \cdot f(x)\)</span> and <span class="math inline">\(Var(x) = \sigma_x^2 = \Sigma \left( (x - \mu_x)^2 \cdot f(x) \right)\)</span>, and we will always end up with these two results. Note that if we are actually adding up terms, since there is no maximum arrival limit, we have to approximate the summation up to a large number of arrivals.</p>
<div id="poisson-example-horse-kicking" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Poisson Example: Horse-Kicking</h3>
<p>Using data from the <a href="https://en.wikipedia.org/wiki/Prussian_Army">Prussian Army</a> on “number of soldiers killed by being kicked by a horse each year in each of 14 cavalry corps over a 20-year period”, <a href="https://en.wikipedia.org/wiki/Ladislaus_Bortkiewicz">Ladislaus Bortkiewicz</a> showed in 1898 in <a href="https://de.wikipedia.org/wiki/Gesetz_der_kleinen_Zahlen">Gesetz der kleinen Zahlen (The Rule of Small Numbers)</a> that this followed the Poisson distribution. This is one of the most famous examples of the Poisson Distribution.</p>
<p>He found that there was 0.70 deaths per one corps per one year.</p>
<p><strong>Chance of 2 death per year per corp</strong></p>
<ul>
<li><span class="math inline">\(x=2\)</span>: 2 death in a corp in a year by horse-kick</li>
<li><span class="math inline">\(\mu=0.70\)</span></li>
</ul>
<p>For example, the chance that <span class="math inline">\(2\)</span> soldier from a corp in a year die of horse kick:
<span class="math display">\[f\left(x=2;\mu=0.7\right) = \frac{0.7^{2} \cdot e^{-0.7}}{2!} = 0.122\]</span></p>
<p>We can use the r function, <em>dpois</em>, to calculate these probabilites: <em>dpois(2, 0.7)</em>. Additionally, <em>ppois(2,0.7)</em> calculates the cumulative probability that at most 2 die from horse-kick in a corp in a year.</p>
<p><strong>Distributional Graphs Horse Kicking Death Per Corp Per Year</strong></p>
<p>We can see from the results below that given our parameter <span class="math inline">\(\mu=0.7\)</span>, there is almost a 50 percent chance that a corp has no death from horse kick in a year. And the chances that 1, 2, 3 and 4 Prussian soldiers die from horse-kick are 35, 12, 3, and 0.5 percent.</p>
<p>The chance that at least 2 soldiers die from each corp each year is 16 percent.</p>
<p>If you are running the Prussian Army, you would want to know these statistics. You would want to track these statistics overtime and try to improve training etc.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="discrete-probability-distribution.html#cb78-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb78-2"><a href="discrete-probability-distribution.html#cb78-2"></a></span>
<span id="cb78-3"><a href="discrete-probability-distribution.html#cb78-3"></a><span class="co"># Parameters</span></span>
<span id="cb78-4"><a href="discrete-probability-distribution.html#cb78-4"></a>n &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb78-5"><a href="discrete-probability-distribution.html#cb78-5"></a>mu &lt;-<span class="st"> </span><span class="fl">0.70</span></span>
<span id="cb78-6"><a href="discrete-probability-distribution.html#cb78-6"></a></span>
<span id="cb78-7"><a href="discrete-probability-distribution.html#cb78-7"></a><span class="co"># Generate Data</span></span>
<span id="cb78-8"><a href="discrete-probability-distribution.html#cb78-8"></a><span class="co"># A vector of different survival counts</span></span>
<span id="cb78-9"><a href="discrete-probability-distribution.html#cb78-9"></a>zero2large &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span>n</span>
<span id="cb78-10"><a href="discrete-probability-distribution.html#cb78-10"></a><span class="co"># Probability for different survival counts</span></span>
<span id="cb78-11"><a href="discrete-probability-distribution.html#cb78-11"></a>prob_of_diekicks &lt;-<span class="st"> </span><span class="kw">dpois</span>(zero2large, mu)</span>
<span id="cb78-12"><a href="discrete-probability-distribution.html#cb78-12"></a><span class="co"># Cumulative Probability for different survival counts, before dbinom, now pbinom</span></span>
<span id="cb78-13"><a href="discrete-probability-distribution.html#cb78-13"></a>cumulative_prob_of_diekicks &lt;-<span class="st"> </span><span class="kw">ppois</span>(zero2large, mu)</span>
<span id="cb78-14"><a href="discrete-probability-distribution.html#cb78-14"></a><span class="co"># Data File that Includes Cumulative Probability and Mass</span></span>
<span id="cb78-15"><a href="discrete-probability-distribution.html#cb78-15"></a>diekick.prob &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">diekicks=</span>(zero2large), <span class="dt">prob=</span>prob_of_diekicks, <span class="dt">cum.prob=</span>cumulative_prob_of_diekicks)</span>
<span id="cb78-16"><a href="discrete-probability-distribution.html#cb78-16"></a></span>
<span id="cb78-17"><a href="discrete-probability-distribution.html#cb78-17"></a><span class="co"># Control Graph Size</span></span>
<span id="cb78-18"><a href="discrete-probability-distribution.html#cb78-18"></a><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">5</span>, <span class="dt">repr.plot.height =</span> <span class="dv">4</span>)</span>
<span id="cb78-19"><a href="discrete-probability-distribution.html#cb78-19"></a><span class="co"># Two axis colors</span></span>
<span id="cb78-20"><a href="discrete-probability-distribution.html#cb78-20"></a>axis.sec.ratio &lt;-<span class="st"> </span><span class="kw">max</span>(cumulative_prob_of_diekicks)<span class="op">/</span><span class="kw">max</span>(prob_of_diekicks)</span>
<span id="cb78-21"><a href="discrete-probability-distribution.html#cb78-21"></a>right.axis.color &lt;-<span class="st"> &#39;blue&#39;</span></span>
<span id="cb78-22"><a href="discrete-probability-distribution.html#cb78-22"></a>left.axis.color &lt;-<span class="st"> &#39;red&#39;</span></span>
<span id="cb78-23"><a href="discrete-probability-distribution.html#cb78-23"></a></span>
<span id="cb78-24"><a href="discrete-probability-distribution.html#cb78-24"></a><span class="co"># Probabilities</span></span>
<span id="cb78-25"><a href="discrete-probability-distribution.html#cb78-25"></a>diekick.graph &lt;-<span class="st"> </span>diekick.prob <span class="op">%&gt;%</span></span>
<span id="cb78-26"><a href="discrete-probability-distribution.html#cb78-26"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>diekicks)) <span class="op">+</span></span>
<span id="cb78-27"><a href="discrete-probability-distribution.html#cb78-27"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y=</span>prob),</span>
<span id="cb78-28"><a href="discrete-probability-distribution.html#cb78-28"></a>             <span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>, <span class="dt">width=</span><span class="fl">0.5</span>, <span class="dt">fill=</span>left.axis.color) <span class="op">+</span></span>
<span id="cb78-29"><a href="discrete-probability-distribution.html#cb78-29"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y=</span>prob,</span>
<span id="cb78-30"><a href="discrete-probability-distribution.html#cb78-30"></a>                  <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="kw">sprintf</span>(<span class="st">&#39;%2.1f&#39;</span>, prob<span class="op">*</span><span class="dv">100</span>), <span class="st">&#39;%&#39;</span>)),</span>
<span id="cb78-31"><a href="discrete-probability-distribution.html#cb78-31"></a>              <span class="dt">vjust =</span> <span class="fl">-0.</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">color=</span>left.axis.color, <span class="dt">fontface=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb78-32"><a href="discrete-probability-distribution.html#cb78-32"></a></span>
<span id="cb78-33"><a href="discrete-probability-distribution.html#cb78-33"></a><span class="co"># Cumulative Probabilities</span></span>
<span id="cb78-34"><a href="discrete-probability-distribution.html#cb78-34"></a>diekick.graph &lt;-<span class="st"> </span>diekick.graph <span class="op">+</span></span>
<span id="cb78-35"><a href="discrete-probability-distribution.html#cb78-35"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>cum.prob<span class="op">/</span>axis.sec.ratio),</span>
<span id="cb78-36"><a href="discrete-probability-distribution.html#cb78-36"></a>              <span class="dt">alpha=</span><span class="fl">0.25</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">color=</span>right.axis.color) <span class="op">+</span></span>
<span id="cb78-37"><a href="discrete-probability-distribution.html#cb78-37"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y=</span>cum.prob<span class="op">/</span>axis.sec.ratio),</span>
<span id="cb78-38"><a href="discrete-probability-distribution.html#cb78-38"></a>               <span class="dt">alpha=</span><span class="fl">0.75</span>, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">shape=</span><span class="dv">23</span>, <span class="dt">fill=</span>right.axis.color) <span class="op">+</span></span>
<span id="cb78-39"><a href="discrete-probability-distribution.html#cb78-39"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y=</span>cum.prob<span class="op">/</span>axis.sec.ratio,</span>
<span id="cb78-40"><a href="discrete-probability-distribution.html#cb78-40"></a>                  <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="kw">sprintf</span>(<span class="st">&#39;%2.0f&#39;</span>, cum.prob<span class="op">*</span><span class="dv">100</span>), <span class="st">&#39;%&#39;</span>)),</span>
<span id="cb78-41"><a href="discrete-probability-distribution.html#cb78-41"></a>              <span class="dt">vjust =</span> <span class="fl">-0.5</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">color=</span>right.axis.color, <span class="dt">fontface=</span><span class="st">&#39;bold&#39;</span>)</span>
<span id="cb78-42"><a href="discrete-probability-distribution.html#cb78-42"></a></span>
<span id="cb78-43"><a href="discrete-probability-distribution.html#cb78-43"></a></span>
<span id="cb78-44"><a href="discrete-probability-distribution.html#cb78-44"></a><span class="co"># Graph Strings</span></span>
<span id="cb78-45"><a href="discrete-probability-distribution.html#cb78-45"></a>graph.title &lt;-<span class="st"> </span><span class="kw">sprintf</span>(</span>
<span id="cb78-46"><a href="discrete-probability-distribution.html#cb78-46"></a>    <span class="kw">paste0</span>(<span class="st">&#39;Death from Horse Kick Per Corp Per Year</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb78-47"><a href="discrete-probability-distribution.html#cb78-47"></a>           <span class="st">&#39;Prob Mass (Left) and Cumulative Prob (Right)&#39;</span>))</span>
<span id="cb78-48"><a href="discrete-probability-distribution.html#cb78-48"></a>graph.caption &lt;-<span class="st"> </span><span class="kw">sprintf</span>(</span>
<span id="cb78-49"><a href="discrete-probability-distribution.html#cb78-49"></a>    <span class="kw">paste0</span>(<span class="st">&#39;Assuming the Poisson properties apply</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb78-50"><a href="discrete-probability-distribution.html#cb78-50"></a>           <span class="st">&#39;Ladislaus Bortkiewicz Prussian Data</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb78-51"><a href="discrete-probability-distribution.html#cb78-51"></a>           <span class="st">&#39;Death By Horse Kick Per Corp Per Year = %s&#39;</span>), mu)</span>
<span id="cb78-52"><a href="discrete-probability-distribution.html#cb78-52"></a>graph.title.x &lt;-<span class="st"> &#39;Number of Soldiers Die of Horse Kick&#39;</span></span>
<span id="cb78-53"><a href="discrete-probability-distribution.html#cb78-53"></a>graph.title.y.axisleft &lt;-<span class="st"> &#39;Prob of x Die of Horse Kick&#39;</span></span>
<span id="cb78-54"><a href="discrete-probability-distribution.html#cb78-54"></a>graph.title.y.axisright &lt;-<span class="st"> &#39;Prob of at Most x Die Of Horse Kick&#39;</span></span>
<span id="cb78-55"><a href="discrete-probability-distribution.html#cb78-55"></a></span>
<span id="cb78-56"><a href="discrete-probability-distribution.html#cb78-56"></a><span class="co"># Graphing</span></span>
<span id="cb78-57"><a href="discrete-probability-distribution.html#cb78-57"></a>diekick.graph &lt;-<span class="st"> </span>diekick.graph <span class="op">+</span></span>
<span id="cb78-58"><a href="discrete-probability-distribution.html#cb78-58"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> graph.title,</span>
<span id="cb78-59"><a href="discrete-probability-distribution.html#cb78-59"></a>         <span class="dt">x =</span> graph.title.x,</span>
<span id="cb78-60"><a href="discrete-probability-distribution.html#cb78-60"></a>         <span class="dt">y =</span> graph.title.y.axisleft,</span>
<span id="cb78-61"><a href="discrete-probability-distribution.html#cb78-61"></a>         <span class="dt">caption =</span> graph.caption) <span class="op">+</span></span>
<span id="cb78-62"><a href="discrete-probability-distribution.html#cb78-62"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">sec.axis =</span></span>
<span id="cb78-63"><a href="discrete-probability-distribution.html#cb78-63"></a>                       <span class="kw">sec_axis</span>(<span class="op">~</span>.<span class="op">*</span>axis.sec.ratio,</span>
<span id="cb78-64"><a href="discrete-probability-distribution.html#cb78-64"></a>                                <span class="dt">name =</span> graph.title.y.axisright)) <span class="op">+</span></span>
<span id="cb78-65"><a href="discrete-probability-distribution.html#cb78-65"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> zero2large[<span class="kw">floor</span>(<span class="kw">seq</span>(<span class="dv">1</span>,n,<span class="dt">length.out=</span><span class="dv">10</span>))],</span>
<span id="cb78-66"><a href="discrete-probability-distribution.html#cb78-66"></a>                       <span class="dt">breaks =</span> zero2large[<span class="kw">floor</span>(<span class="kw">seq</span>(<span class="dv">1</span>,n,<span class="dt">length.out=</span><span class="dv">10</span>))]) <span class="op">+</span></span>
<span id="cb78-67"><a href="discrete-probability-distribution.html#cb78-67"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">face=</span><span class="st">&#39;bold&#39;</span>),</span>
<span id="cb78-68"><a href="discrete-probability-distribution.html#cb78-68"></a>          <span class="dt">axis.text.y.right =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> right.axis.color),</span>
<span id="cb78-69"><a href="discrete-probability-distribution.html#cb78-69"></a>          <span class="dt">axis.text.y.left =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> left.axis.color))</span>
<span id="cb78-70"><a href="discrete-probability-distribution.html#cb78-70"></a></span>
<span id="cb78-71"><a href="discrete-probability-distribution.html#cb78-71"></a><span class="co"># Print</span></span>
<span id="cb78-72"><a href="discrete-probability-distribution.html#cb78-72"></a><span class="kw">print</span>(diekick.graph)</span></code></pre></div>
<p><img src="Introductory-Statistics-with-R-tidyverse_files/figure-html/unnamed-chunk-78-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="discrete-probability-distribution.html#cb79-1"></a><span class="co"># Tabular</span></span>
<span id="cb79-2"><a href="discrete-probability-distribution.html#cb79-2"></a><span class="kw">round</span>(<span class="kw">as.tibble</span>(diekick.prob), <span class="dv">3</span>)</span></code></pre></div>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="basics-of-probability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="index-and-code-links.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Introductory-Statistics-with-R-tidyverse.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
